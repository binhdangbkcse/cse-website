jQuery((function(t){t.productsVariations=function(e){let n=t(e),o={},i={};t.data(e,"productsVariations",n),o={init:function(){if(elementorFrontend.isEditMode())return;n.find("[data-product_variations]").each((function(){const e=t(this),n=e.data("post-id"),a=e.data("product_variations"),r=e.find(".products-variations"),s=e.find(".box-button"),c=e.find("span.price"),u=o.findOutOfStockAttributes(a);i[n]={state:{},variations:a,outOfStockAttributes:u,$addToCartButton:s,$variations:r,$originPrice:c.clone(),$price:c},o.makeOutOfStockAttributesVisible(r,u),r.find("li a").data("the7_product_data",i[n]),s.attr("data-product_id",""),s.on("click",(function(e){t(this).is(".variation-btn-disabled")&&e.preventDefault()}))}));const e=n.find(".ajax-variation-enabled .products-variations li a");if(t(".touchevents").length){let n,i;e.on("touchstart",(function(t){n=t.originalEvent.touches[0].pageY,i=t.originalEvent.touches[0].pageX})),e.on("touchend",(function(e){e.preventDefault();let a=e.originalEvent.changedTouches[0].pageX,r=e.originalEvent.changedTouches[0].pageY;if(n===r||i===a){const e=t(this);o.chooseVariations(e)}}))}else e.on("click",(function(e){e.preventDefault();const n=t(this);o.chooseVariations(n)}));if(!!t("html.mobile-true").length){const e=new The7ElementorSettings(n),i=e.getSettings("variations_position"),a=e.getSettings("button_position"),r=n.find(".trigger-img-hover");r.each((function(){const e=t(this);let s,c;if(e.hasClass("woo-ready"))return;const u=!!e.closest(".product-type-variable",n).length;e.on("touchstart",(function(t){s=t.originalEvent.touches[0].pageY,c=t.originalEvent.touches[0].pageX})),e.on("touchend",(function(e){const n=t(this),d=e.originalEvent.changedTouches[0].pageX,l=e.originalEvent.changedTouches[0].pageY,f=!n.hasClass("is-clicked");let h=f;if(f){let f;if(n.hasClass("woo-buttons-on-img"))f=!0;else{const t=n.find(".woo-buttons-on-img").get(0);f=e.originalEvent&&t&&e.originalEvent.composedPath().includes(t)}if(f&&t(e.target).closest(".products-variations-wrap, .woo-list-buttons",n).length){const t=a&&"on_image_hover"!==a;(!u||i&&"on_image_hover"!==i)&&t&&(h=!1)}if(s==l||c==d){r.removeClass("is-clicked"),n.addClass("is-clicked");const t={boundaryElement:n.get(0),$affectedElements:r};elementorFrontend.elements.$body.off("touchstart",o.onOuterTouchHandler).on("touchstart",t,o.onOuterTouchHandler)}}h&&e.preventDefault()})),e.addClass("woo-ready")}))}},chooseVariations:function(e){if(e.is(".out-of-stock"))return;const n=e.parent(),i=e.data("id"),a=e.closest("ul").attr("data-atr"),r=e.data("the7_product_data");n.hasClass("active")?(n.removeClass("active"),r.state[a]=""):(n.siblings().removeClass("active"),n.addClass("active"),r.state[a]=String(i));let s=Object.assign({},r.outOfStockAttributes);o.findMatchingOutOfStockVariations(r.variations,r.state).forEach((function(t){for(const[e,n]of Object.entries(t.attributes))r.state[e]!==n&&(s[e]=s[e].slice()||[],-1===s[e].indexOf(n)&&s[e].push(n))})),o.makeOutOfStockAttributesVisible(r.$variations,s);const c=o.findMatchingVariation(r.variations,r.state);c?(r.$addToCartButton.attr("data-product_id",c.variation_id),r.$addToCartButton.removeClass("variation-btn-disabled"),c.price_html&&o.updateProductPriceData(r,t(c.price_html))):(r.$addToCartButton.attr("data-product_id",""),r.$addToCartButton.addClass("variation-btn-disabled"),o.updateProductPriceData(r,r.$originPrice.clone()))},makeOutOfStockAttributesVisible:function(t,e){const n=t.find("li a");n.removeClass("out-of-stock");for(const[t,o]of Object.entries(e))if(o.length){const e=o.slice().map((function(e){return"."+t+"_"+e})).join(",");n.filter(e).addClass("out-of-stock")}},onOuterTouchHandler:function(t){t.originalEvent&&t.data&&t.data.boundaryElement&&!t.originalEvent.composedPath().includes(t.data.boundaryElement)&&t.data.$affectedElements&&t.data.$affectedElements.removeClass("is-clicked")&&elementorFrontend.elements.$body.off("touchstart",o.onOuterTouchHandler)},findMatchingOutOfStockVariations:function(t,e){for(var n=[],o=0;o<t.length;o++){var i=t[o];!i.is_in_stock&&this.isMatch(i.attributes,e)&&n.push(i)}return n},isMatch:function(t,e){var n=!1;for(var o in t)if(t.hasOwnProperty(o)){var i=t[o],a=e[o];void 0!==i&&void 0!==a&&0!==i.length&&0!==a.length&&i===a&&(n=!0)}return n},findMatchingVariation:function(t,e){for(var n=[],o=0;o<t.length;o++){var i=t[o];this.isExactMatch(i.attributes,e)&&n.push(i)}return n.shift()},isExactMatch:function(t,e){var n=!0;for(var o in t)if(t.hasOwnProperty(o)){var i=t[o],a=e[o];(void 0===i||void 0===a||0===a.length||0!==i.length&&i!==a)&&(n=!1)}return n},updateProductPriceData:function(t,e){t.$price.replaceWith(e),t.$price=e},findOutOfStockAttributes:function(t){let e=[],n=[],o={};for(let o=0;o<t.length;o++){let i=t[o];i.is_in_stock?e.push(Object.entries(i.attributes)):n.push(Object.entries(i.attributes))}e=[].concat(...e),n=[].concat(...n);const i=function(t,e){const n=e[0],o=e[1];return t[n]=t[n]||[],t[n].push(o),t},a=e.reduce(i,{}),r=n.reduce(i,{});for(const[t,e]of Object.entries(r))a[t]&&(o[t]=e.filter((function(e){return!a[t].includes(e)})));return o}},o.init()},t.fn.productsVariations=function(){return this.each((function(){void 0!==t(this).data("productsVariations")&&t(this).removeData("productsVariations"),new t.productsVariations(this)}))}})),jQuery(window).on("elementor/frontend/init",(function(){const t=function(t,e){e((function(){t.productsVariations()}))};elementorFrontend.hooks.addAction("frontend/element_ready/the7-wc-products.default",t),elementorFrontend.hooks.addAction("frontend/element_ready/the7-wc-products-carousel.default",t)}));